# Введение

Серверная часть системы по обслуживанию торговых ботов. Алгоритм:

* **Сервер приема** принимает сигналы от торгового бота сигналиста
* **Сервер приема** проверяет учетную запись и адреса ботов клиентов, подписавшихся на сигналиста
* **Бот клиента** получает сигнал
* ...

# Установка

## Под Windows

* Установить [mongo](https://www.mongodb.com/download-center?jmp=nav#community) Communitys server, разработка велась под версией 3.6.4
* Первый запуск
  * Запустить базу данных, выполнив комманду mongod в окне комманд в субдиреткории bin, папки куда была совершенна установка 
```
mongod --dbpath /Users/olegsokolansky/Projects/wheel-db/ --port 27017 --replSet rs0 --bind_ip localhost,192.168.1.6
```
  * **/Users/olegsokolansky/Projects/wheel-db/** - путь к папке с файлами базы данных
  * **rs0** идентификатор группы репликации 
  * **192.168.1.6** IP-адресс или хост-имя системы на котором запущенна база данных
* Если IP-адресс или хост-имя системы изменились
  * В новом окне комманд выполнить следующее
```
mongo
use local
cfg = db.system.replset.findOne()
cfg.members[0].host = '192.168.1.6'
db.system.replset.reconfig(cfg)
db.system.replset.update({_id: "rs0"},cfg)
```
  * В новом окне комманд выполнить следующее
```
mongod --dbpath /Users/olegsokolansky/Projects/wheel-db/ --port 27017 --replSet rs0 --bind_ip localhost,192.168.1.6
```
  * **/Users/olegsokolansky/Projects/wheel-db/** - путь к папке с файлами базы данных
  * **rs0** идентификатор группы репликации 
  * **192.168.1.6** новы IP-адресс или хост-имя системы на котором запущенна база данных
* Установить [node и npm](https://nodejs.org/en/) рекомендованной версии, разработка велась под 8.11.1
* Скопировать файлы репозитария на диск в директорию **C:\Program Files (x86)\Autobot**
* Изменить значения конфигруации в файле config.js
  * Если база данных находится не локально или не на порте по умолчанию, заполнить поля host и port секции db
  * Указать порты на который следует ожидать прихода пакетов от сигналиста в поле ports, секции reception
* Запустить **Сервер приема**, выполнив комманду node reception-server.js в окне комманд в диреткории, куда были скопированы файлы
```
C:\Program Files (x86)\Autobot>node reception-server.js
```
* Запустить **Бот клиента**, выполнив комманду node client-bot.js в окне комманд в диреткории, куда были скопированы файлы
```
C:\Program Files (x86)\Autobot>node client-bot.js
```

# Коллекции базы данных

## inbound

Содержит входящие пакеты и результат их обработки

## signalists

Содержит учетную запись бот сигналиста, и адреса клиенских ботов

